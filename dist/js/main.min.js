const formularioBusca=document.getElementById("formularioBusca"),formularioCadastro=document.getElementById("formularioCadastro"),formularioObservacao=document.getElementById("formularioObservacao"),formularioObservacaoEdicao=document.getElementById("formularioObservacaoEdicao"),pagina=window.location.pathname,socket=io();function AcessarOrdem(){var e=localStorage.getItem("numeroOrdem");localStorage.setItem("statusObservacao","desatualizada"),window.location="ordem.html?numero="+e}function CadastrarOrdemBuscada(){var e=localStorage.getItem("numeroOrdem");socket.emit("cadastro",e),socket.on("sucessoCadastro",function(){AcessarOrdem()})}function AmpliarImagem(e){document.getElementById("PopUpImagem").style.display="none",leitor.readAsDataURL(e)}if("/index.html"==pagina&&(formularioBusca.addEventListener("submit",function(e){e.preventDefault();e=e.target.elements.numeroBusca.value;0==String(e).length||4<String(e).length||e<=0?document.getElementById("PopUpErroBuscaIntervalo").style.display="flex":(localStorage.setItem("numeroOrdem",e),socket.emit("busca",e))}),socket.on("sucessoBusca",function(e){e?(numeroOrdem=localStorage.getItem("numeroOrdem"),AcessarOrdem()):document.getElementById("PopUpErroBusca").style.display="flex"})),"/cadastro-ordem.html"==pagina&&(formularioCadastro.addEventListener("submit",function(e){e.preventDefault();e=e.target.elements.numeroCadastro.value;0==String(e).length||e<=0||4<String(e).length?document.getElementById("PopUpErroCadastroMaior").style.display="flex":(localStorage.setItem("numeroOrdem",e),socket.emit("cadastro",e))}),socket.on("sucessoCadastro",function(e){e?document.getElementById("PopUpCadastro").style.display="flex":document.getElementById("PopUpErroCadastroExiste").style.display="flex"})),"/ordem.html"==pagina){let e=document.getElementById("enviarImagemPre");var imagemPre01=document.getElementById("imagemPre01");e.addEventListener("change",function(){var a=this.files[0];if(a){const e=new FileReader;e.addEventListener("load",function(){imagemPre01.setAttribute("src",this.result)}),e.readAsDataURL(a)}}),formularioObservacao.addEventListener("submit",function(e){e.preventDefault();var a=localStorage.getItem("numeroOrdem"),e=e.target.elements.inputObservacao.value;255<e.length?(document.getElementById("PopUpObservacaoVazia").style.display="none",document.getElementById("PopUpErroEdicaoObservacao").style.display="flex"):e.length<=0?(localStorage.removeItem("observacao"),socket.emit("alteracaoObservacao",null,a)):(localStorage.removeItem("observacao"),socket.emit("alteracaoObservacao",e,a))}),formularioObservacaoEdicao.addEventListener("submit",function(e){e.preventDefault();var a=localStorage.getItem("numeroOrdem"),e=e.target.elements.inputObservacao.value;localStorage.setItem("observacao",e),255<e.length?(document.getElementById("PopUpEdicaoObservacao").style.display="none",document.getElementById("PopUpErroEdicaoObservacao").style.display="flex"):e.length<=0?(localStorage.removeItem("observacao"),socket.emit("alteracaoObservacao",null,a)):(localStorage.removeItem("observacao"),socket.emit("alteracaoObservacao",e,a))}),socket.on("resultadoAlteracaoObservacao",function(e){e?(localStorage.setItem("statusObservacao","desatualizada"),location.reload()):(console.log("falha ao alterar a observação"),document.getElementById("PopUpEdicaoObservacao").style.display="none",document.getElementById("PopUpErroEdicaoObservacao").style.display="flex")}),socket.on("sucessoCadastro",function(e){e?document.getElementById("PopUpCadastro").style.display="flex":document.getElementById("PopUpErroCadastroExiste").style.display="flex"}),socket.on("sucessoExclusao",function(e){e?paraIndex():document.getElementById("PopUpErroExclusaoOrdem").style.display="flex"}),socket.on("temObservacao",function(e){var a=localStorage.getItem("statusObservacao");null!==e?localStorage.setItem("observacao",e):localStorage.removeItem("observacao");localStorage.getItem("observacao");"desatualizada"==a&&(localStorage.setItem("statusObservacao","atualizada"),location.reload())})}function AcessarObservacao(){null==localStorage.getItem("observacao")?document.getElementById("PopUpObservacaoVazia").style.display="flex":document.getElementById("PopUpObservacaoPreenchida").style.display="flex"}function ExibirConfirmacaoAlteracaoObservacao(){document.getElementById("PopUpEdicaoObservacao").style.display="none",document.getElementById("PopUpConfirmacaoAlteracao").style.display="flex"}function ConfirmarEdicaoObservacao(){var e,a=evento.target.elements.inputObservacao.value;255<a.length?(document.getElementById("PopUpEdicaoObservacao").style.display="none",document.getElementById("PopUpErroEdicaoObservacao").style.display="flex"):(e=localStorage.getItem("numeroOrdem"),localStorage.removeItem("observacao"),socket.emit("alteracaoObservacao",a,e))}function ExibirConfirmacaoExclusaoOrdem(){document.getElementById("PopUpExclusao").style.display="flex"}function ExcluirOrdem(){var e=localStorage.getItem("numeroOrdem");socket.emit("exclusao",e)}window.onload=function(){let e=localStorage.getItem("numeroOrdem");var a=localStorage.getItem("observacao"),t=localStorage.getItem("statusObservacao");e.replace(/['"]+/g," "),document.getElementById("conteudoObservacao").innerHTML=a,document.getElementById("TituloOrdem").innerHTML="ordem #"+e,socket.emit("conferirObservacao",e),"atualizada"==t&&null==a&&(document.getElementById("LinkOrdem").innerHTML="adicionar observação")},"/ordem.html"!==pagina&&localStorage.setItem("statusObservacao","desatualizada"),window.addEventListener("keydown",function(e){void 0!==e.key&&"F12"!==e.key&&"F5"!==e.key&&(e.preventDefault(),e.key,document.activeElement.click(),"Escape"==e.key&&fecharPopUp(),"F1"==e.key&&abrirPainelAjuda())});var isPainelAjudaAberto=!1,guiaAberto="nenhum";function paraIndex(){window.location="index.html"}function paraCadastroOrdem(){window.location="cadastro-ordem.html"}function abrirPainelAjuda(){isPainelAjudaAberto=isPainelAjudaAberto?"nenhum"!==guiaAberto?("consulta"==guiaAberto?document.getElementById("AjudaConsulta").style.display="none":"cadastro"==guiaAberto?document.getElementById("AjudaCadastro").style.display="none":"alteracao"==guiaAberto?document.getElementById("AjudaAlteracao").style.display="none":"adicaoImagem"==guiaAberto?document.getElementById("AjudaAdicaoImagem").style.display="none":"remocaoImagem"==guiaAberto?document.getElementById("AjudaRemocaoImagem").style.display="none":"extra"==guiaAberto&&(document.getElementById("AjudaExtra").style.display="none"),document.querySelector(".modal-ajuda__content__items").style.display="block",guiaAberto="nenhum",!0):!(document.querySelector(".modal-ajuda").style.display="none"):(document.querySelector(".modal-ajuda").style.display="flex",document.querySelector(".modal-ajuda__content__items").style.display="block",!0)}function abrirItemAjuda(e){document.querySelector(".modal-ajuda__content__items").style.display="none","consulta"==e?(document.getElementById("AjudaConsulta").style.display="block",guiaAberto="consulta"):"cadastro"==e?(document.getElementById("AjudaCadastro").style.display="block",guiaAberto="cadastro"):"alteracao"==e?(document.getElementById("AjudaAlteracao").style.display="block",guiaAberto="alteracao"):"adicaoImagem"==e?(document.getElementById("AjudaAdicaoImagem").style.display="block",guiaAberto="adicaoImagem"):"remocaoImagem"==e?(document.getElementById("AjudaRemocaoImagem").style.display="block",guiaAberto="remocaoImagem"):"extra"==e&&(document.getElementById("AjudaExtra").style.display="block",guiaAberto="extra")}function fecharPopUp(){isPainelAjudaAberto&&(document.querySelector(".modal-ajuda").style.display="none","consulta"==guiaAberto?document.getElementById("AjudaConsulta").style.display="none":"cadastro"==guiaAberto?document.getElementById("AjudaCadastro").style.display="none":"alteracao"==guiaAberto?document.getElementById("AjudaAlteracao").style.display="none":"adicaoImagem"==guiaAberto?document.getElementById("AjudaAdicaoImagem").style.display="none":"remocaoImagem"==guiaAberto?document.getElementById("AjudaRemocaoImagem").style.display="none":"extra"==guiaAberto&&(document.getElementById("AjudaExtra").style.display="none"),isPainelAjudaAberto=!1,guiaAberto="nenhum"),"/cadastro-ordem.html"==pagina&&(document.getElementById("PopUpCadastro").style.display="none",document.getElementById("PopUpErroCadastroExiste").style.display="none",document.getElementById("PopUpErroCadastroMaior").style.display="none"),"/index.html"!=pagina&&"/resultados-busca.html"!=pagina||(document.getElementById("PopUpErroBusca").style.display="none",document.getElementById("PopUpErroBuscaIntervalo").style.display="none"),"/ordem.html"==pagina&&(document.getElementById("PopUpExclusao").style.display="none",document.getElementById("PopUpObservacaoVazia").style.display="none",document.getElementById("PopUpObservacaoPreenchida").style.display="none",document.getElementById("PopUpEdicaoObservacao").style.display="none",document.getElementById("PopUpConfirmacaoAlteracao").style.display="none",document.getElementById("PopUpErroEdicaoObservacao").style.display="none")}function AbrirPopUpCadastro(){document.getElementById("PopUpCadastro").style.display="flex"}function AbrirPopUpEdicaoObservacao(){document.getElementById("PopUpObservacaoPreenchida").style.display="none",document.getElementById("PopUpEdicaoObservacao").style.display="flex"}